<!--
  ~ Licensed to the Apache Software Foundation (ASF) under one or more
  ~ contributor license agreements.  See the NOTICE file distributed with
  ~ this work for additional information regarding copyright ownership.
  ~ The ASF licenses this file to You under the Apache License, Version 2.0
  ~ (the "License"); you may not use this file except in compliance with
  ~ the License.  You may obtain a copy of the License at
  ~
  ~    http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  ~
  -->

<div fxFlex="100" fxLayout="column" style="margin-top:40px;">
    <div fxFlex="100" fxLayout="row wrap" fxLayoutAlign="start stretch">
        <div fxFlex="100" class="assemblyOptions sp-blue-bg" style="padding:5px;">
            <div fxLayout="row" fxLayoutAlign="start center" fxFlex="100">
                <h4>Node Overview</h4>
                <span flex></span>
            </div>
        </div>
        <div fxFlex="100" fxLayoutAlign="start start" class="sp-blue-border page-container-padding-inner">
            <mat-grid-list
                    [cols]="3" [rowHeight]="300"
                    [gutterSize]="10" fxFlex="100">

                <mat-grid-tile class="gray" *ngFor="let node of nodes">
                    <mat-card class="node-card">
                        <mat-card-header class="header">
                            <div class="div-icon-node-actions">
                                <button mat-icon-button class="node-mat-icon-button"
                                        [disabled]="node.active"
                                        (click)="changeNodeState(node, true)">
                                    <mat-icon
                                            [ngClass]="node.active ? 'node-activated' : 'node-inactive'"
                                            matTooltip="{{node.active ? 'node alive and running' : 'activate node'}}"
                                            matTooltipPosition="above">
                                        play_circle_filled
                                    </mat-icon>
                                </button>
                                <button mat-icon-button class="node-mat-icon-button"
                                        [disabled]="!node.active"
                                        (click)="changeNodeState(node, false)">
                                    <mat-icon
                                            [ngClass]="node.active ? 'node-inactive' : 'node-deactivated'"
                                            matTooltip="{{!node.active ? 'node deactivated' : 'deactivate node'}}"
                                            matTooltipPosition="above">
                                        pause_circle_filled
                                    </mat-icon>
                                </button>
                                <button mat-icon-button class="node-mat-icon-button"
                                        [disabled]="node.active"
                                        (click)="evict(node)">
                                    <mat-icon
                                            [ngClass]="node.active ? 'node-inactive' : 'node-evict'"
                                            matTooltip="{{!node.active ? 'evict processors' :
                                            'evict processors option not available'}}"
                                            matTooltipPosition="above">
                                        swap_horizontal_circle_filled
                                    </mat-icon>
                                </button>
                                <button mat-icon-button class="node-mat-icon-button"
                                        matTooltip="Edit node configuration"
                                        matTooltipPosition="above"
                                        (click)="settings(node)">
                                    <mat-icon
                                            [ngClass]="'node-inactive'">
                                        info
                                    </mat-icon>
                                </button>
                            </div>
<!--                            <div mat-card-avatar class="node-header-avatar"><i class="fas fa-server fa-2x"></i></div>-->
                            <div mat-card-avatar class="node-header-avatar">
                                <button mat-icon-button class="node-mat-icon-button" disabled>
                                    <mat-icon [ngClass]="'node-inactive'">
                                        storage
                                    </mat-icon>
                                </button>
                            </div>
                            <mat-card-title
                                    style="font-size: 12pt">{{node.nodeControllerId}}</mat-card-title>
                            <mat-card-subtitle style="font-size: 10pt">{{node.hostname}} |
                                <b>{{node.nodeResources.softwareResource.os}}</b></mat-card-subtitle>
                        </mat-card-header>
                        <mat-card-content>
                            <div class="div-node-tag" *ngFor="let tag of node.staticNodeMetadata.locationTags">
                                <span class="span-node-tag">{{tag}}</span>&nbsp;
                            </div>
                            <div class="div-sa-tag" *ngFor="let device of node.nodeResources.fieldDeviceAccessResourceList">
                                <span class="span-sa-tag">{{device.deviceName}}</span>&nbsp;
                            </div>
                            <hr/>
                            <div>
                                <ul class="ft-foot">
                                    <li><span class="inclusion" style="color: darkgray"><i
                                            class="fas fa-microchip"></i></span><b>{{node.nodeResources.hardwareResource.cpu.cores}}</b> cores
                                    </li>
                                    <li><span class="inclusion"
                                              style="color: darkgray"><i class="fas fa-memory"></i></span><b>{{this.bytesToGB(node.nodeResources.hardwareResource.memory.memTotal)}}</b> GiB</li>
                                    <li><span class="inclusion"
                                              style="color: darkgray"><i class="fas fa-hdd"></i></span><b>{{this.bytesToGB(node.nodeResources.hardwareResource.disk.diskTotal)}}</b>
                                        GiB</li>
                                </ul>
                                <ul class="ft-foot">
                                    <li><span class="inclusion"
                                              style="color: darkgray"><i class="fas fa-cube"></i></span>{{node.nodeResources.hardwareResource.cpu.arch}}</li>
                                    <li><span class="inclusion"
                                              style="color: darkgray"><i class="fab fa-docker"></i></span>{{node.nodeResources.softwareResource.containerRuntime.serverVersion}}</li>
                                    <li><span class="inclusion"
                                              style="color: darkgray"><i class="fas fa-meteor"></i></span>GPU
                                        <b>{{nvidiaRuntime(node)}}</b></li>
                                </ul>
                            </div>
                            <div *ngFor="let container of node.registeredContainers">
                                <span>{{container.containerName}}</span>
                            </div>
                        </mat-card-content>
                        <mat-card-actions>
                        </mat-card-actions>
                    </mat-card>
                </mat-grid-tile>
            </mat-grid-list>
        </div>
    </div>
</div>